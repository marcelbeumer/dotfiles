[ -z "$HTTPDCONF" ] && \
    echo "Please set HTTPDCONF"

[ -z "$DOTFILES_ENV" ] && \
    echo "Please set DOTFILES_ENV"

set -o vi
alias l="ls"
alias la="ls -ahl"
alias ll="ls -ahl"
alias tree="find . -type d -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'"
alias jdate="date +%d\ %h\ %Y\ %H:%M" # journaling date
alias vi=vim

# Dev
alias a2start="sudo apachectl start"
alias a2restart="sudo apachectl restart"
alias a2stop="sudo apachectl stop"
alias a2="a2restart"
alias vimhttpd="mvim $HTTPDCONF"
alias serve="python -m SimpleHTTPServer"


function proxysocks() {
    if [ -z "$3" ]; then
        echo "usage: proxysocks \"<connection>\" <port> <country>"
        return
    fi
    echo "Enabling proxysocks"
    networksetup -setsocksfirewallproxy $1 localhost $2
    ssh proxy-user@proxy-$3.marcelbeumer.com -ND $2
    unproxysocks $1
}

function unproxysocks() {
    if [ -z "$1" ]; then
        echo "usage: unproxysocks \"<connection>\""
        return
    fi
    echo "Disabling proxysocks"
    networksetup -setsocksfirewallproxystate $1 off
}

# Mac only
if [ "$DOTFILES_ENV" == "mac" ]; then
    alias vi="mvim -v"
    alias vim="mvim"

    # mdfind from ., showing linenumbers
    function m() {
        mdfind -onlyin . $@ | lines
    }

    # mdfind by name from ., showing linenumbers
    function mn() {
        mdfind -onlyin . -name $@ | lines
    }

    # show line numbers for stdin
    function lines() {
        n=1
        while read line; do
            (( n++ ))
            echo $n: $line
        done
    }

    # get content of line number, use in combination with m or mn:
    # mn code.js | ml 2
    function ml() {
        cat - | sed -n "$1p" | awk '{ print $2 }'
    }

    # https://github.com/paulirish/dotfiles/commit/e67d1bc03
    # cd into whatever is the forefront Finder window.
    cdf() {  # short for cdfinder
    cd "`osascript -e 'tell app "Finder" to POSIX path of (insertion location as alias)'`"
    }

    #Notes
    export NOTES=~/Documents/Notes
    export WRITING_REPOS=~/Development/Clones/writing
    alias start-writing="cd $WRITING_REPOS;  npm start -- --build=me"
    alias start-tech-writing="cd $WRITING_REPOS;  npm start -- --build=me"
    alias add-content="$WRITING_REPOS/bin/add-content"
    alias add-log="$WRITING_REPOS/bin/add-content --build=me --type=log"
    alias add-tech-log="$WRITING_REPOS/bin/add-content --build=me --type=tech"
fi
